{"version":3,"sources":["logo.svg","App.js","index.js"],"names":["module","exports","__webpack_require__","p","App","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","year","data","filteredData","totals","bike","run","workout","filter","streaks","current","start","length","longest","Promise","resolve","Tabletop","init","key","callback","sheets","elements","wanted","rawData","map","day","date","Number","comments","reduce","total","dayDiff","dateFrom","dateTo","Math","abs","Date","acc","curr","fetchData","prevProps","prevState","_this2","setState","calculateFilteredData","_this3","loadSheet","then","normalize","calculateYearlyTotals","calculateStreaksOfActivity","ReactTooltip","rebuild","catch","e","console","error","bikeWeight","includes","runWeight","workoutWeight","objectSpread","score","_this4","react_default","a","createElement","className","src","logo","alt","build_default","startDate","concat","endDate","values","classForValue","showWeekdayLabels","tooltipDataAttrs","value","lines","push","data-tip","join","weekdayLabels","type","checked","onChange","role","aria-label","floor","style","marginTop","dist_default","effect","multiline","Component","ReactDOM","render","src_App_0","document","getElementById"],"mappings":"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","file":"static/js/main.d6819905.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.ff816526.svg\";","import React, { Component } from 'react';\nimport CalendarHeatmap from 'react-calendar-heatmap';\nimport Tabletop from 'tabletop';\nimport ReactTooltip from 'react-tooltip'\n\nimport logo from './logo.svg';\nimport './App.css';\nimport './react-calendar-heatmap.css';\n\nclass App extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      year: '2019',\n      // data: [  // example data\n      //   { date: '2018-06-01', bike: \"25\", run: \"0\", workout: \"60\", comments: \"been there, done that\" },\n      //   { date: '2018-06-03', bike: \"48\", run: \"0\", workout: \"\" },\n      //   { date: '2018-06-06', bike: \"3\", run: \"10\", workout: \"\" },\n      // ],\n      data: [],\n      filteredData: [],\n      totals: {\n        bike: 0, // km\n        run: 0, // km\n        workout: 0, //mins\n      },\n      filter: 'all',\n      streaks: { current: { start: '', length: 0 }, longest: { start: '', length: 0 } },\n    };\n  }\n\n  loadSheet(year) {\n    // TODO error handling\n    return new Promise((resolve) => {\n      const sheetUrl = 'https://docs.google.com/spreadsheets/d/1CK1dlXslA7_wRth0SYvTf4wY2xgzk2gKGD1uw6SVyKg/edit?usp=sharing';\n\n      const callback = (sheets) => {\n        resolve(sheets[year].elements);\n      };\n      Tabletop.init({ key: sheetUrl, callback, wanted: [year] });\n    });\n  }\n\n  normalize(rawData) {\n    return rawData.map(day => ({\n      date: day.date,\n      bike: Number(day.bike || 0),\n      run: Number(day.run || 0),\n      workout: Number(day.workout || 0),\n      comments: day.comments,\n    }))\n    // filter out the days with no activity\n    .filter(day => (day.bike + day.run + day.workout > 0));\n  }\n\n  calculateYearlyTotals(data) {\n    return data.reduce((total, day) => {\n      total.bike += day.bike;\n      total.run += day.run;\n      total.workout += day.workout;\n      return total;\n    }, { bike: 0, run: 0, workout: 0 });\n  }\n\n  calculateStreaksOfActivity(data) {\n    const dayDiff = (dateFrom, dateTo) => Math.abs(new Date(dateTo) - new Date(dateFrom)) / (1000 * 60 * 60 * 24);\n\n    // find the longest streak of activity\n    const streaks = data.reduce((acc, curr) => {\n      if (!acc.start) {\n        return { start: curr.date, length: 1, longest: { start: curr.date, length: 1 } };\n      }\n      if (dayDiff(acc.start, curr.date) === acc.length) { // streak continues\n        acc.length++;\n      } else { // streak interrupted\n        if (acc.length > acc.longest.length) {\n          acc.longest = { start: acc.start, length: acc.length };\n        }\n        acc.start = curr.date;\n        acc.length = 1;\n      }\n      return acc;\n    }, {});\n\n    // see if the current streak is the longest one\n    const longest = (streaks.length > streaks.longest.length)\n      ? { start: streaks.start, length: streaks.length }\n      : streaks.longest;\n\n    const current = dayDiff(streaks.start, new Date()) <= streaks.length + 1\n      ? { start: streaks.start, length: streaks.length }\n      : { length: 0 };\n\n    return { longest, current };\n  }\n\n  componentWillMount() {\n    this.fetchData(this.state.year);\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (this.state.year !== prevState.year) {\n      this.fetchData(this.state.year);\n    }\n    if (this.state.filter !== prevState.filter) {\n      this.setState(state => ({\n        filteredData: this.calculateFilteredData(state.data, state.filter)\n      }));\n    }\n  }\n\n  fetchData(year) {\n    this.loadSheet(year)\n      .then(rawData => {\n        // console.log(rawData);\n        // debugger;\n\n        const data = this.normalize(rawData);\n        const totals = this.calculateYearlyTotals(data);\n        const streaks = this.calculateStreaksOfActivity(data);\n        const filter = 'all';\n        const filteredData = this.calculateFilteredData(data, filter);\n        this.setState({ data, totals, streaks, filter, filteredData });\n\n        ReactTooltip.rebuild();\n      })\n      .catch(e => console.error(e));\n  }\n\n  calculateFilteredData(data, filter) {\n    // weights: 5km by bike is my equivalent of a 1km run or a 10min workout\n    const bikeWeight = ['all', 'bike'].includes(filter) ? 1 : 0;\n    const runWeight = ['all', 'run'].includes(filter) ? 5 : 0;\n    const workoutWeight = ['all', 'workout'].includes(filter) ? 0.5 : 0;\n\n    // calculate the \"day score\"\n    return data.map(day => ({\n      ...day,\n      score: day.bike * bikeWeight + day.run * runWeight + day.workout * workoutWeight,\n    }));\n  }\n\n  classForValue(day) {\n    if (!day) return 'color-empty';\n\n    if (day.score === 0) return 'color-empty';\n    if (day.score < 10) return 'color-github-1';\n    if (day.score < 25) return 'color-github-2';\n    if (day.score < 50) return 'color-github-3';\n    return 'color-github-4';\n  }\n\n  render() {\n    const customTooltipDataAttrs = (value) => {\n      if (!value || !value.date) return;\n\n      const lines = [ value.date ];\n      value.bike && lines.push(`${value.bike} km by bike`);\n      value.run && lines.push(`${value.run} km ran`);\n      value.workout && lines.push(`${value.workout} min of workout`);\n      value.comments && lines.push(value.comments);\n\n      return { 'data-tip': lines.join('<br />') };\n    };\n    return (\n      <div className=\"App\">\n        <header className=\"App-header\">\n          <img src={logo} className=\"App-logo\" alt=\"logo\" />\n          <h1 className=\"App-title\">Unstoppable.</h1>\n        </header>\n        <div className=\"HeatmapContainer\">\n          <div className=\"Heatmap\">\n            <CalendarHeatmap\n              startDate={new Date(`${this.state.year}-01-01`)}\n              endDate={new Date(`${this.state.year}-12-31`)}\n              values={this.state.filteredData}\n              classForValue={this.classForValue}\n              showWeekdayLabels\n              tooltipDataAttrs={customTooltipDataAttrs}\n              weekdayLabels={['', 'Mo', '', 'We', '', 'Fri', '']}\n            />\n          </div>\n          <div className=\"Filters\">\n            <div>\n              <input type=\"radio\"\n                checked={this.state.filter === 'all'}\n                onChange={() => this.setState({ filter: 'all' })}\n              />\n              <span role=\"img\" aria-label=\"all\"> &#x1F30D;</span>\n            </div>\n            <div>\n              <input type=\"radio\"\n                checked={this.state.filter === 'bike'}\n                onChange={() => this.setState({ filter: 'bike' })}\n              />\n              <span role=\"img\" aria-label=\"bike\"> &#x1F6B4;</span>\n            </div>\n            <div>\n              <input type=\"radio\"\n                checked={this.state.filter === 'run'}\n                onChange={() => this.setState({ filter: 'run' })}\n              />\n              <span role=\"img\" aria-label=\"run\"> &#x1F3C3;</span>\n            </div>\n            <div>\n              <input type=\"radio\"\n                checked={this.state.filter === 'workout'}\n                onChange={() => this.setState({ filter: 'workout' })}\n              />\n              <span role=\"img\" aria-label=\"workout\"> &#x1F3CB;</span>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"Totals\">\n          Total of {this.state.totals.bike} km by &#x1F6B4;, {this.state.totals.run} km by &#x1F3C3;\n          and {Math.floor(this.state.totals.workout / 60)} hours of &#x1F3CB; this year.<br/>\n          Current streak of activity is {this.state.streaks.current.length} days. Longest is {this.state.streaks.longest.length} days.\n        </div>\n\n        <div style={{ marginTop: '20px' }}>\n          <input type=\"radio\"\n            checked={this.state.year === '2018'}\n            onChange={() => this.setState({ year: '2018' })}\n          /> 2018\n          <input type=\"radio\"\n            checked={this.state.year === '2019'}\n            onChange={() => this.setState({ year: '2019' })}\n          /> 2019\n        </div>\n\n        <ReactTooltip effect=\"solid\" multiline />\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}